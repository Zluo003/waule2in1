import{r as l,j as e}from"./react-vendor-BvY2dB7B.js";import{u as De,b as d,c as o}from"./index-bQ3BRhJc.js";import"./reactflow-D8v6_Qvs.js";import"./utils-BcyDR7Vi.js";const $e=()=>{var se;const{user:a,updateUser:D,refreshUser:L,clearAuth:ne}=De(),[m,ie]=l.useState((a==null?void 0:a.nickname)||""),[k,x]=l.useState(""),[M,S]=l.useState(""),[B,U]=l.useState(!1),[$,F]=l.useState(!1),[I,O]=l.useState(!1),W=l.useRef(null),[f,G]=l.useState(""),[h,V]=l.useState(""),[C,Y]=l.useState(""),[z,u]=l.useState(""),[J,R]=l.useState(""),[q,H]=l.useState(!1),[A,de]=l.useState(!1),[j,ce]=l.useState(!1),[s,oe]=l.useState(null),[xe,ue]=l.useState(!0),[me,E]=l.useState(!1),[K,Q]=l.useState(!1),[i,N]=l.useState({type:"CREDITS",alipayAccount:"",alipayName:""}),[b,he]=l.useState("overview"),[X,be]=l.useState([]),[y,ge]=l.useState([]),[Z,pe]=l.useState([]),[P,v]=l.useState([]),[fe,je]=l.useState(!0),[ee,_]=l.useState(0),[g,w]=l.useState(null),T=l.useCallback(async()=>{try{const[t,r,n,c]=await Promise.all([d.get("/referral/info"),d.get("/referral/list"),d.get("/referral/commissions"),d.get("/referral/withdrawals")]);t.success&&oe(t.data),r.success&&be(r.data.list||[]),n.success&&ge(n.data.list||[]),c.success&&pe(c.data.list||[])}catch{}finally{ue(!1)}},[]),te=l.useCallback(async()=>{try{const[t,r]=await Promise.all([d.get("/messages"),d.get("/messages/unread-count")]);t.success&&v(t.data.list||[]),r.success&&_(r.data.count||0)}catch{}finally{je(!1)}},[]),Ne=async t=>{if(w(t),!t.isRead)try{await d.put(`/messages/${t.id}/read`),v(r=>r.map(n=>n.id===t.id?{...n,isRead:!0}:n)),_(r=>Math.max(0,r-1))}catch{}},ye=async t=>{try{await d.delete(`/messages/${t}`),v(r=>r.filter(n=>n.id!==t)),w(null),o.success("消息已删除")}catch{o.error("删除失败")}},ve=async()=>{if(confirm("确定清空所有消息？"))try{await d.delete("/messages"),v([]),_(0),o.success("已清空所有消息")}catch{o.error("清空失败")}};l.useEffect(()=>{L(),T(),te()},[T,te]);const we=t=>({ADMIN:"管理员",USER:"普通用户",VIP:"VIP用户",SVIP:"SVIP用户",INTERNAL:"内部用户"})[t]||t,ke=t=>({ADMIN:"bg-red-500/10 dark:bg-red-500/20 text-red-600 dark:text-red-400 border-red-500/30",USER:"bg-gray-500/10 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400 border-gray-500/30",VIP:"bg-amber-500/10 dark:bg-amber-500/20 text-amber-600 dark:text-amber-400 border-amber-500/30",SVIP:"bg-tiffany-500/10 dark:bg-tiffany-500/20 text-tiffany-600 dark:text-tiffany-400 border-tiffany-500/30",INTERNAL:"bg-blue-500/10 dark:bg-blue-500/20 text-blue-600 dark:text-blue-400 border-blue-500/30"})[t]||"bg-gray-500/10 dark:bg-gray-500/20 text-gray-600 dark:text-gray-400 border-gray-500/30",ae=async t=>{if(!t||t.trim().length===0)return x("昵称不能为空"),!1;if(t.length>20)return x("昵称长度不能超过20个字符"),!1;if(t===(a==null?void 0:a.nickname))return x(""),!0;U(!0);try{const r=await d.user.checkNickname(t);return r.available?(x(""),!0):(x(r.message||"该昵称已被使用"),!1)}catch{return x("检查昵称失败，请稍后重试"),!1}finally{U(!1)}},Se=async()=>{var r,n;if(!(m===(a==null?void 0:a.nickname)||!await ae(m))){F(!0);try{const c=await d.user.updateProfile({nickname:m});c.success?(D(c.data),S("昵称更新成功"),x(""),setTimeout(()=>S(""),3e3)):x(c.message||"更新失败")}catch(c){x(((n=(r=c.response)==null?void 0:r.data)==null?void 0:n.message)||"更新失败，请稍后重试")}finally{F(!1)}}},Ce=async()=>{var t,r;if(u(""),R(""),!f){u("请输入当前密码");return}if(!h){u("请输入新密码");return}if(h.length<6){u("新密码长度不能少于6位");return}if(h!==C){u("两次输入的新密码不一致");return}H(!0);try{const n=await d.user.changePassword({currentPassword:f,newPassword:h});n.success?(R("密码修改成功"),G(""),V(""),Y(""),setTimeout(()=>R(""),3e3)):u(n.message||"修改失败")}catch(n){u(((r=(t=n.response)==null?void 0:t.data)==null?void 0:r.message)||"修改失败，请稍后重试")}finally{H(!1)}},Re=async t=>{var c,re,le;const r=(c=t.target.files)==null?void 0:c[0];if(!r)return;if(!["image/jpeg","image/png","image/gif","image/webp"].includes(r.type)){alert("只支持 JPG、PNG、GIF 和 WebP 格式的图片");return}if(r.size>5*1024*1024){alert("图片大小不能超过 5MB");return}O(!0);try{const p=await d.user.uploadAvatar(r);p.success?(D(p.data),alert("头像上传成功")):alert(p.message||"上传失败")}catch(p){alert(((le=(re=p.response)==null?void 0:re.data)==null?void 0:le.message)||"上传失败，请稍后重试")}finally{O(!1)}},Ae=()=>{s!=null&&s.referralCode&&(navigator.clipboard.writeText(s.referralCode),o.success("推荐码已复制"))},Ee=()=>{if(s!=null&&s.referralCode){const t=`${window.location.origin}/login?ref=${s.referralCode}`;navigator.clipboard.writeText(t),o.success("推荐链接已复制")}},Pe=async()=>{if(s){if(s.referralBalance<s.config.minWithdrawAmount){o.error(`余额不足，最低提现金额为 ${(s.config.minWithdrawAmount/100).toFixed(0)} 元`);return}if(i.type==="ALIPAY"&&(!i.alipayAccount||!i.alipayName)){o.error("请填写支付宝账号和姓名");return}Q(!0);try{const t=await d.post("/referral/withdraw",{amount:s.referralBalance,type:i.type,alipayAccount:i.alipayAccount,alipayName:i.alipayName});t.success?(o.success(t.message),E(!1),T(),L()):o.error(t.message)}catch(t){o.error(t.message||"提现失败")}finally{Q(!1)}}},_e={PENDING:"待处理",APPROVED:"已通过",COMPLETED:"已完成",REJECTED:"已拒绝"},Te={PENDING:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-400",APPROVED:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-400",COMPLETED:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400",REJECTED:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400"};return e.jsxs("div",{className:"h-full flex items-center justify-center p-8",children:[e.jsxs("div",{className:"w-full max-w-6xl flex gap-6",children:[e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx("div",{className:"bg-white dark:bg-[#18181b] border border-neutral-200 dark:border-neutral-800 rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,0.12)] dark:shadow-[0_8px_30px_rgba(0,0,0,0.5)] overflow-hidden h-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs("div",{className:"relative group flex-shrink-0",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-neutral-100 dark:bg-neutral-800 overflow-hidden",children:a!=null&&a.avatar?e.jsx("img",{src:a.avatar,alt:a.nickname||a.username,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"material-symbols-outlined text-3xl text-neutral-400 dark:text-neutral-500",children:"account_circle"})})}),e.jsx("button",{onClick:()=>{var t;return(t=W.current)==null?void 0:t.click()},disabled:I,className:"absolute -bottom-1 -right-1 w-6 h-6 rounded-full bg-neutral-800 dark:bg-white text-white dark:text-black flex items-center justify-center shadow-md hover:scale-110 transition-all disabled:opacity-50",children:I?e.jsx("span",{className:"material-symbols-outlined text-sm animate-spin",children:"progress_activity"}):e.jsx("span",{className:"material-symbols-outlined text-sm",children:"photo_camera"})}),e.jsx("input",{ref:W,type:"file",accept:"image/jpeg,image/png,image/gif,image/webp",onChange:Re,className:"hidden"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg font-semibold text-neutral-900 dark:text-white truncate",children:(a==null?void 0:a.nickname)||(a==null?void 0:a.username)||"未命名用户"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${ke((a==null?void 0:a.role)||"USER")}`,children:we((a==null?void 0:a.role)||"USER")}),e.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:[(a==null?void 0:a.credits)||0," 积分"]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-neutral-500 dark:text-neutral-400 mb-2",children:"昵称"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("input",{type:"text",value:m,onChange:t=>{ie(t.target.value),x(""),S("")},onBlur:()=>{m&&m!==(a==null?void 0:a.nickname)&&ae(m)},maxLength:20,className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-white placeholder-neutral-400 focus:outline-none focus:ring-1 focus:ring-neutral-400 transition-all",placeholder:"输入昵称"}),B&&e.jsx("div",{className:"absolute right-2 top-1/2 -translate-y-1/2",children:e.jsx("span",{className:"material-symbols-outlined text-neutral-400 text-base animate-spin",children:"progress_activity"})})]}),e.jsx("button",{onClick:Se,disabled:$||B||!m||m===(a==null?void 0:a.nickname)||!!k,className:"px-4 py-2 bg-neutral-800 dark:bg-white text-white dark:text-black rounded-lg text-sm font-medium hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:$?"...":"保存"})]}),k&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:k}),M&&e.jsx("p",{className:"mt-1 text-xs text-green-500",children:M})]}),e.jsxs("div",{className:"pt-4 border-t border-neutral-100 dark:border-neutral-800",children:[e.jsx("label",{className:"block text-xs font-medium text-neutral-500 dark:text-neutral-400 mb-2",children:"账号信息"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[(a==null?void 0:a.phone)&&e.jsxs("div",{className:"flex justify-between py-1.5",children:[e.jsx("span",{className:"text-neutral-500 dark:text-neutral-400",children:"手机号"}),e.jsx("span",{className:"text-neutral-900 dark:text-white",children:a.phone})]}),(a==null?void 0:a.email)&&e.jsxs("div",{className:"flex justify-between py-1.5",children:[e.jsx("span",{className:"text-neutral-500 dark:text-neutral-400",children:"邮箱"}),e.jsx("span",{className:"text-neutral-900 dark:text-white",children:a.email})]}),e.jsxs("div",{className:"flex justify-between py-1.5",children:[e.jsx("span",{className:"text-neutral-500 dark:text-neutral-400",children:"用户ID"}),e.jsxs("span",{className:"text-neutral-900 dark:text-white font-mono text-xs",children:[(se=a==null?void 0:a.id)==null?void 0:se.slice(0,8),"..."]})]})]})]}),(a==null?void 0:a.loginType)==="ADMIN"&&e.jsxs("div",{className:"pt-4 border-t border-neutral-100 dark:border-neutral-800",children:[e.jsx("label",{className:"block text-xs font-medium text-neutral-500 dark:text-neutral-400 mb-2",children:"修改密码"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:A?"text":"password",value:f,onChange:t=>{G(t.target.value),u("")},className:"w-full px-3 py-2 pr-10 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-white placeholder-neutral-400 focus:outline-none focus:ring-1 focus:ring-neutral-400",placeholder:"当前密码"}),e.jsx("button",{type:"button",onClick:()=>de(!A),className:"absolute right-2 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600",children:e.jsx("span",{className:"material-symbols-outlined text-base",children:A?"visibility_off":"visibility"})})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:j?"text":"password",value:h,onChange:t=>{V(t.target.value),u("")},className:"w-full px-3 py-2 pr-10 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-white placeholder-neutral-400 focus:outline-none focus:ring-1 focus:ring-neutral-400",placeholder:"新密码（至少6位）"}),e.jsx("button",{type:"button",onClick:()=>ce(!j),className:"absolute right-2 top-1/2 -translate-y-1/2 text-neutral-400 hover:text-neutral-600",children:e.jsx("span",{className:"material-symbols-outlined text-base",children:j?"visibility_off":"visibility"})})]}),e.jsx("input",{type:j?"text":"password",value:C,onChange:t=>{Y(t.target.value),u("")},className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm text-neutral-900 dark:text-white placeholder-neutral-400 focus:outline-none focus:ring-1 focus:ring-neutral-400",placeholder:"确认新密码"}),z&&e.jsx("p",{className:"text-xs text-red-500",children:z}),J&&e.jsx("p",{className:"text-xs text-green-500",children:J}),e.jsx("button",{onClick:Ce,disabled:q||!f||!h||!C,className:"w-full py-2 bg-neutral-800 dark:bg-white text-white dark:text-black rounded-lg text-sm font-medium hover:opacity-90 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:q?"修改中...":"确认修改"})]})]}),e.jsx("div",{className:"pt-4 border-t border-neutral-100 dark:border-neutral-800",children:e.jsx("button",{onClick:ne,className:"w-full py-2 rounded-lg text-sm font-medium text-red-500 hover:bg-red-50 dark:hover:bg-red-500/10 transition-all",children:"退出登录"})})]})]})})}),e.jsx("div",{className:"flex-1",children:e.jsx("div",{className:"bg-white dark:bg-[#18181b] border border-neutral-200 dark:border-neutral-800 rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,0.12)] dark:shadow-[0_8px_30px_rgba(0,0,0,0.5)] overflow-hidden h-full",children:e.jsx("div",{className:"p-6",children:xe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("span",{className:"material-symbols-outlined text-2xl text-neutral-400 animate-spin",children:"progress_activity"})}):s!=null&&s.config.isActive?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl text-orange-500",children:"share"}),e.jsx("h2",{className:"text-lg font-semibold text-neutral-900 dark:text-white",children:"推荐返利"})]}),e.jsx("div",{className:"flex gap-1 text-xs",children:["overview","referrals","commissions","withdrawals"].map(t=>e.jsx("button",{onClick:()=>he(t),className:`px-3 py-1.5 rounded-lg transition-colors ${b===t?"bg-neutral-800 dark:bg-white text-white dark:text-black":"bg-neutral-100 dark:bg-neutral-800 text-neutral-600 dark:text-neutral-400 hover:bg-neutral-200 dark:hover:bg-neutral-700"}`,children:t==="overview"?"概览":t==="referrals"?"邀请明细":t==="commissions"?"返利明细":"提现记录"},t))})]}),b==="overview"&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-pink-500 rounded-xl p-4 text-white mb-4",children:[e.jsx("div",{className:"text-xs opacity-80 mb-1",children:"我的推荐码"}),e.jsx("div",{className:"text-2xl font-bold tracking-wider mb-3",children:s==null?void 0:s.referralCode}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Ae,className:"flex-1 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-medium transition-colors",children:"复制推荐码"}),e.jsx("button",{onClick:Ee,className:"flex-1 py-1.5 bg-white/20 hover:bg-white/30 rounded-lg text-xs font-medium transition-colors",children:"复制链接"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[e.jsxs("div",{className:"text-center p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsx("div",{className:"text-xl font-bold text-neutral-900 dark:text-white",children:(s==null?void 0:s.referralCount)||0}),e.jsx("div",{className:"text-xs text-neutral-500",children:"已邀请"})]}),e.jsxs("div",{className:"text-center p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsxs("div",{className:"text-xl font-bold text-orange-500",children:["¥",(((s==null?void 0:s.referralTotalEarned)||0)/100).toFixed(0)]}),e.jsx("div",{className:"text-xs text-neutral-500",children:"累计返利"})]}),e.jsxs("div",{className:"text-center p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsxs("div",{className:"text-xl font-bold text-green-500",children:["¥",(((s==null?void 0:s.referralBalance)||0)/100).toFixed(0)]}),e.jsx("div",{className:"text-xs text-neutral-500",children:"可提现"})]})]}),s&&s.referralBalance>=s.config.minWithdrawAmount?e.jsxs("button",{onClick:()=>E(!0),className:"w-full py-2.5 bg-orange-500 hover:bg-orange-600 text-white rounded-lg text-sm font-medium transition-colors",children:["提现 ¥",(s.referralBalance/100).toFixed(2)]}):e.jsxs("div",{className:"text-center text-xs text-neutral-400 py-2",children:["满 ",(((s==null?void 0:s.config.minWithdrawAmount)||2e4)/100).toFixed(0)," 元可提现"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-900 rounded-xl p-4 mb-4",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white mb-3",children:"奖励规则"}),e.jsxs("div",{className:"space-y-2 text-xs text-neutral-600 dark:text-neutral-400",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-blue-100 dark:bg-blue-900/30 rounded-full flex items-center justify-center text-blue-500 text-[10px] font-bold",children:"1"}),e.jsxs("span",{children:["邀请好友注册，您获得 ",e.jsx("b",{className:"text-blue-500",children:s==null?void 0:s.config.referrerBonus})," 积分"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-green-100 dark:bg-green-900/30 rounded-full flex items-center justify-center text-green-500 text-[10px] font-bold",children:"2"}),e.jsxs("span",{children:["好友注册后获得 ",e.jsx("b",{className:"text-green-500",children:s==null?void 0:s.config.refereeBonus})," 积分"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-orange-100 dark:bg-orange-900/30 rounded-full flex items-center justify-center text-orange-500 text-[10px] font-bold",children:"3"}),e.jsxs("span",{children:["好友充值，您获得 ",e.jsxs("b",{className:"text-orange-500",children:[(((s==null?void 0:s.config.commissionRate)||0)*100).toFixed(0),"%"]})," 返现"]})]})]})]}),e.jsxs("div",{className:"bg-neutral-50 dark:bg-neutral-900 rounded-xl p-4",children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white mb-3",children:"最近返利"}),y.length===0?e.jsx("div",{className:"text-xs text-neutral-400 text-center py-4",children:"暂无返利记录"}):e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:y.slice(0,5).map(t=>{var r,n;return e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"text-neutral-600 dark:text-neutral-400 truncate flex-1",children:((r=t.referee)==null?void 0:r.nickname)||((n=t.referee)==null?void 0:n.username)||"用户"}),e.jsx("div",{className:t.type==="REGISTER_BONUS"?"text-blue-500":"text-orange-500",children:t.type==="REGISTER_BONUS"?`+${t.amount}积分`:`+¥${(t.amount/100).toFixed(2)}`})]},t.id)})})]})]})]}),b==="referrals"&&e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:X.length===0?e.jsx("div",{className:"text-center py-8 text-neutral-400 text-sm",children:"暂无邀请记录"}):X.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-neutral-200 dark:bg-neutral-700 rounded-full flex items-center justify-center",children:t.avatar?e.jsx("img",{src:t.avatar,alt:"",className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"material-symbols-outlined text-neutral-400 text-sm",children:"person"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:t.nickname||t.username||"未知用户"}),e.jsx("div",{className:"text-xs text-neutral-400",children:new Date(t.createdAt).toLocaleDateString()})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-orange-500",children:["+¥",(t.totalCommission/100).toFixed(2)]}),e.jsx("div",{className:"text-xs text-neutral-400",children:"累计返利"})]})]},t.id))}),b==="commissions"&&e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:y.length===0?e.jsx("div",{className:"text-center py-8 text-neutral-400 text-sm",children:"暂无返利记录"}):y.map(t=>{var r,n;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:t.type==="REGISTER_BONUS"?"邀请注册奖励":"充值返利"}),e.jsxs("div",{className:"text-xs text-neutral-400",children:[((r=t.referee)==null?void 0:r.nickname)||((n=t.referee)==null?void 0:n.username)||"用户"," · ",new Date(t.createdAt).toLocaleString()]})]}),e.jsx("div",{className:`text-sm font-medium ${t.type==="REGISTER_BONUS"?"text-blue-500":"text-orange-500"}`,children:t.type==="REGISTER_BONUS"?`+${t.amount} 积分`:`+¥${(t.amount/100).toFixed(2)}`})]},t.id)})}),b==="withdrawals"&&e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:Z.length===0?e.jsx("div",{className:"text-center py-8 text-neutral-400 text-sm",children:"暂无提现记录"}):Z.map(t=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-neutral-50 dark:bg-neutral-900 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-neutral-900 dark:text-white",children:t.type==="ALIPAY"?"提现到支付宝":"兑换积分"}),e.jsx("div",{className:"text-xs text-neutral-400",children:new Date(t.createdAt).toLocaleString()})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs rounded ${Te[t.status]}`,children:_e[t.status]}),e.jsxs("div",{className:"text-sm font-medium text-orange-500",children:["¥",(t.amount/100).toFixed(2)]})]})]},t.id))})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-neutral-400",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"share_off"}),e.jsx("p",{className:"text-sm",children:"推荐系统暂未开放"})]})})})}),e.jsx("div",{className:"w-80 flex-shrink-0",children:e.jsx("div",{className:"bg-white dark:bg-[#18181b] border border-neutral-200 dark:border-neutral-800 rounded-2xl shadow-[0_8px_30px_rgba(0,0,0,0.12)] dark:shadow-[0_8px_30px_rgba(0,0,0,0.5)] overflow-hidden h-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"material-symbols-outlined text-xl text-blue-500",children:"mail"}),e.jsx("h2",{className:"text-lg font-semibold text-neutral-900 dark:text-white",children:"消息"}),ee>0&&e.jsx("span",{className:"px-1.5 py-0.5 text-xs bg-red-500 text-white rounded-full",children:ee})]}),P.length>0&&e.jsx("button",{onClick:ve,className:"text-xs text-neutral-400 hover:text-red-500 transition-colors",children:"清空"})]}),fe?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx("span",{className:"material-symbols-outlined text-2xl text-neutral-400 animate-spin",children:"progress_activity"})}):P.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-neutral-400",children:[e.jsx("span",{className:"material-symbols-outlined text-4xl mb-2",children:"inbox"}),e.jsx("p",{className:"text-sm",children:"暂无消息"})]}):e.jsx("div",{className:"space-y-2 max-h-80 overflow-y-auto",children:P.map(t=>e.jsx("div",{onClick:()=>Ne(t),className:`p-3 rounded-lg cursor-pointer transition-colors ${t.isRead?"bg-neutral-50 dark:bg-neutral-900":"bg-blue-50 dark:bg-blue-900/20 border-l-2 border-blue-500"}`,children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:`text-sm font-medium truncate ${t.isRead?"text-neutral-600 dark:text-neutral-400":"text-neutral-900 dark:text-white"}`,children:t.title}),e.jsx("div",{className:"text-xs text-neutral-400 mt-1",children:new Date(t.createdAt).toLocaleDateString()})]}),!t.isRead&&e.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1.5"})]})},t.id))})]})})})]}),g&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-[#18181b] rounded-2xl p-6 w-full max-w-md mx-4 border border-neutral-200 dark:border-neutral-800",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white",children:g.title}),e.jsx("button",{onClick:()=>w(null),className:"text-neutral-400 hover:text-neutral-600",children:e.jsx("span",{className:"material-symbols-outlined",children:"close"})})]}),e.jsx("div",{className:"text-xs text-neutral-400 mb-4",children:new Date(g.createdAt).toLocaleString()}),e.jsx("div",{className:"text-sm text-neutral-700 dark:text-neutral-300 whitespace-pre-wrap mb-6",children:g.content}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>w(null),className:"flex-1 py-2 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm",children:"关闭"}),e.jsx("button",{onClick:()=>ye(g.id),className:"flex-1 py-2 bg-red-500 text-white rounded-lg text-sm font-medium hover:bg-red-600",children:"删除"})]})]})}),me&&s&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white dark:bg-[#18181b] rounded-2xl p-6 w-full max-w-sm mx-4 border border-neutral-200 dark:border-neutral-800",children:[e.jsx("h3",{className:"text-lg font-bold text-neutral-900 dark:text-white mb-4",children:"提现申请"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm text-neutral-500 mb-1",children:"提现金额"}),e.jsxs("div",{className:"text-2xl font-bold text-orange-500",children:["¥",(s.referralBalance/100).toFixed(2)]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"text-sm text-neutral-500 mb-2",children:"提现方式"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{className:`flex-1 py-2 rounded-lg text-sm border transition-colors ${i.type==="CREDITS"?"border-orange-500 bg-orange-50 dark:bg-orange-900/20 text-orange-600":"border-neutral-200 dark:border-neutral-700 text-neutral-600 dark:text-neutral-400"}`,onClick:()=>N({...i,type:"CREDITS"}),children:"兑换积分"}),e.jsx("button",{className:`flex-1 py-2 rounded-lg text-sm border transition-colors ${i.type==="ALIPAY"?"border-orange-500 bg-orange-50 dark:bg-orange-900/20 text-orange-600":"border-neutral-200 dark:border-neutral-700 text-neutral-600 dark:text-neutral-400"}`,onClick:()=>N({...i,type:"ALIPAY"}),children:"支付宝"})]})]}),i.type==="CREDITS"&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-xs text-blue-600 dark:text-blue-400",children:["可兑换 ",Math.floor(s.referralBalance/100*s.config.withdrawToCreditsRate)," 积分，即时到账"]}),i.type==="ALIPAY"&&e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("input",{type:"text",value:i.alipayName,onChange:t=>N({...i,alipayName:t.target.value}),placeholder:"支付宝真实姓名",className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm"}),e.jsx("input",{type:"text",value:i.alipayAccount,onChange:t=>N({...i,alipayAccount:t.target.value}),placeholder:"支付宝账号",className:"w-full px-3 py-2 bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm"}),e.jsx("div",{className:"p-2 bg-yellow-50 dark:bg-yellow-900/20 rounded-lg text-xs text-yellow-600",children:"人工审核，1-3个工作日到账"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>E(!1),className:"flex-1 py-2 border border-neutral-200 dark:border-neutral-700 rounded-lg text-sm",children:"取消"}),e.jsx("button",{onClick:Pe,disabled:K,className:"flex-1 py-2 bg-orange-500 text-white rounded-lg text-sm font-medium hover:bg-orange-600 disabled:opacity-50",children:K?"处理中...":"确认"})]})]})})]})};export{$e as default};
