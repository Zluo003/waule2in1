; WauleAPI Supervisor 配置
; 管理 sora-api (Python) 和 node-gateway (Node.js) 服务

[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0
loglevel=info
user=root

[unix_http_server]
file=/tmp/supervisor.sock

[rpcinterface:supervisor]
supervisor.rpcinterface_factory=supervisor.rpcinterface:make_main_rpcinterface

[supervisorctl]
serverurl=unix:///tmp/supervisor.sock

; ==================== Sora API (Python) ====================
; sora2api 服务 - 提供 Token 管理和视频生成功能
[program:sora-api]
command=python main.py
directory=/app/sora-api
autostart=true
autorestart=true
startsecs=5
startretries=3
stopwaitsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=PYTHONUNBUFFERED=1
priority=100

; ==================== Node Gateway ====================
; 统一 API 网关 - 提供 v1/images, v1/videos, v1/sora 等接口
[program:node-gateway]
command=node dist/index.js
directory=/app/node-gateway
autostart=true
autorestart=true
startsecs=3
startretries=3
stopwaitsecs=10
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=NODE_ENV=production
priority=200
